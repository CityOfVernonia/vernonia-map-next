import{q6 as e,q7 as t,l7 as a}from"./vendor.c9efa5f2.js";import{CIMSymbolRasterizer as l}from"./CIMSymbolRasterizer.689923bf.js";import"./cimAnalyzer.85620094.js";import"./CIMSymbolHelper.25e22272.js";import"./callExpressionWithFeature.d55a75a7.js";import"./Rasterizer.aec59460.js";const i=new l(null,!0);async function o(l,o={}){const{size:s,maxSize:n,node:r,opacity:m}=o,c=o.cimOptions||o,{feature:p,fieldMap:y,geometryType:d,style:h}=c,u=e(l),g=Math.min(null!=s?s:u,null!=n?n:a(120));g!==u&&(l=l.clone(),t(l,g,{preserveOutlineWidth:!0}));let M=3;l&&l.data&&l.data.symbol&&"CIMPointSymbol"!==l.data.symbol.type&&(M=1);const b=await i.rasterizeCIMSymbolAsync(l,p,y,d,{scaleFactor:M,style:h}),f=document.createElement("canvas");f.width=b.imageData.width,f.height=b.imageData.height,f.getContext("2d").putImageData(b.imageData,0,0);let C=f.width/M,I=f.height/M;if(null!=s&&(null==(null==o?void 0:o.scale)||(null==o?void 0:o.scale))){const e=C/I;C=e<=1?Math.ceil(g*e):g,I=e<=1?g:Math.ceil(g/e)}const w=new Image(C,I);return w.src=f.toDataURL(),null!=m&&(w.style.opacity=`${m}`),r&&r.appendChild(w),w}export{o as previewCIMSymbol};
