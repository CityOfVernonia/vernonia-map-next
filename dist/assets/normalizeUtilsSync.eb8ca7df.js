import{cf as n,cH as t,cV as s,cI as e,cp as i,cF as m,cg as x,ck as a,cW as c,cX as r,cY as o,cZ as f}from"./vendor.c9efa5f2.js";function u(n){if(!n)return null;if("mesh"===n.type)return n.toJSON();let u=null;const p=n.spatialReference,g=t(p);if(!g)return n.toJSON();const v=p.isWebMercator?102100:4326,M=s[v].maxX,J=s[v].minX,N=s[v].plus180Line,O=s[v].minus180Line;let S;const b=n.toJSON();if(e(b))S=l(b,M,J);else if(i(b))b.points=b.points.map((n=>l(n,M,J))),S=b;else if(m(b))S=function(n,t){if(!t)return n;const s=function(n,t){const s=[],{ymin:e,ymax:i}=n,m=n.xmax-n.xmin,x=n.xmin,a=n.xmax;let c;const[r,o]=t.valid;c=y(n.xmin,t);const f=c.x,u=c.frameId;c=y(n.xmax,t);const l=c.x,p=c.frameId,d=f===l&&m>0;if(m>2*o){const n={xmin:x<a?f:l,ymin:e,xmax:o,ymax:i},t={xmin:r,ymin:e,xmax:x<a?l:f,ymax:i},m={xmin:0,ymin:e,xmax:o,ymax:i},c={xmin:r,ymin:e,xmax:0,ymax:i},y=[],d=[];h(n,m)&&y.push(u),h(n,c)&&d.push(u),h(t,m)&&y.push(p),h(t,c)&&d.push(p);for(let s=u+1;s<p;s++)y.push(s),d.push(s);s.push({extent:n,frameIds:[u]},{extent:t,frameIds:[p]},{extent:m,frameIds:y},{extent:c,frameIds:d})}else f>l||d?s.push({extent:{xmin:f,ymin:e,xmax:o,ymax:i},frameIds:[u]},{extent:{xmin:r,ymin:e,xmax:l,ymax:i},frameIds:[p]}):s.push({extent:{xmin:f,ymin:e,xmax:l,ymax:i},frameIds:[u]});return s}(n,t).map((n=>n.extent));return s.length<2?s[0]||n:s.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:s.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}(b,g);else if(x(b)||a(b)){const n=I;c(n,b);const t={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},s=f(t.xmin,J)*(2*M),e=0===s?b:function(n,t){const s=o(n);for(const e of s)for(const n of e)n[0]+=t;return n}(b,s);t.xmin+=s,t.xmax+=s,r(t,N)&&t.xmax!==M||r(t,O)&&t.xmin!==J?u=e:S=e}else S=n.toJSON();return null!==u?(new d).cut(u,M):S}function l(n,t,s){if(Array.isArray(n)){const e=n[0];if(e>t){const s=f(e,t);n[0]=e+s*(-2*t)}else if(e<s){const t=f(e,s);n[0]=e+t*(-2*s)}}else{const e=n.x;if(e>t){const s=f(e,t);n.x+=s*(-2*t)}else if(e<s){const t=f(e,s);n.x+=t*(-2*s)}}return n}function y(n,t){const[s,e]=t.valid,i=2*e;let m,x=0;return n>e?(m=Math.ceil(Math.abs(n-e)/i),n-=m*i,x=m):n<s&&(m=Math.ceil(Math.abs(n-s)/i),n+=m*i,x=-m),{x:n,frameId:x}}function h(n,t){const{xmin:s,ymin:e,xmax:i,ymax:m}=t;return p(n,s,e)&&p(n,s,m)&&p(n,i,m)&&p(n,i,e)}function p(n,t,s){return t>=n.xmin&&t<=n.xmax&&s>=n.ymin&&s<=n.ymax}class d{cut(n,t){let s;if(n.rings)this.closed=!0,s=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,s=n.paths,this.minPts=2}const e=s.length,i=-2*t;for(let m=0;m<e;m++){const n=s[m];if(n&&n.length>=this.minPts){const t=[];for(const s of n)t.push([s[0]+i,s[1]]);s.push(t)}}return this.closed?n.rings=s:n.paths=s,n}}const I=n();export{u as l};
