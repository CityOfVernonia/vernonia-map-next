var t=Object.defineProperty,e=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;import{eM as a,jK as p,a8 as c,jL as u,jM as l,be as f,jN as g,jO as m,jP as y,jQ as j,jR as v,jS as d,eK as h,eL as b,jT as w}from"./vendor.c9efa5f2.js";import{i as O}from"./multiOriginJSONSupportUtils.8ffcafd7.js";function I(t){return P[function(t){return t instanceof Blob?t.type:function(t){const e=a(t);return U[e]||x}(t.url)}(t)]||S}const P={},x="text/plain",S=P[x],U={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const F in U)P[U[F]]=F;function R(t){const d=c(t)&&t.origins?t.origins:[void 0];return(h,b)=>{const P=function(t,p,d){if(c(t)&&"resource"===t.type)return function(t,p,d){const h=v(p,d);return{type:String,read:(t,e,r)=>{const n=u(t,e,r);return h.type===String?n:"function"==typeof h.type?new h.type({url:n}):void 0},write:{writer(p,u,v,b){if(!b||!b.resources)return"string"==typeof p?void(u[v]=l(p,b)):void(u[v]=p.write({},b));const w=function(t){return f(t)?null:"string"==typeof t?t:t.url}(p),P=w?l(w,((t,n)=>e(t,r(n)))(((t,e)=>{for(var r in e||(e={}))o.call(e,r)&&s(t,r,e[r]);if(n)for(var r of n(e))i.call(e,r)&&s(t,r,e[r]);return t})({},b),{verifyItemRelativeUrls:b&&b.verifyItemRelativeUrls?{writtenUrls:b.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null}),1):null,x=h.type!==String&&(!O(this)||b&&b.origin&&this.originIdOf(d)>g(b.origin));b&&b.portalItem&&c(P)&&!m(P)?x?function(t,e,r,n,o,i,s,p){const c=s.portalItem.resourceFromPath(n),u=$(r,n,s);I(u)===a(c.path)?(N(t,e,c,u,s.resources.toUpdate),o[i]=n):z(t,e,r,n,o,i,s,p)}(this,d,p,P,u,v,b,t):function(t,e,r,n){n.resources.toKeep.push({resource:n.portalItem.resourceFromPath(t)}),e[r]=t}(P,u,v,b):b&&b.portalItem&&(f(P)||c(y(P))||j(P)||x)?z(this,d,p,P,u,v,b,t):u[v]=P}}}}(t,p,d);switch(c(t)&&t.type?t.type:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:t,write:e}=w;return{read:t,write:e}}}}(t,h,b);for(const t of d){const e=p(h,t,b);for(const t in P)e[t]=P[t]}}}function z(t,e,r,n,o,i,s,a){const p=d(),c=$(r,n,s),u=h(b(a,"prefix"),p),l=`${u}.${I(c)}`,f=s.portalItem.resourceFromPath(l);j(n)&&s.resources.pendingOperations.push(async function(t){const e=(await import("./vendor.c9efa5f2.js").then((function(t){return t.s4}))).default,{data:r}=await e(t,{responseType:"blob"});return r}(n).then((t=>{f.path=`${u}.${I(t)}`,o[i]=f.itemRelativeUrl})).catch((()=>{}))),N(t,e,f,c,s.resources.toAdd),o[i]=f.itemRelativeUrl}function N(t,e,r,n,o){o.push({resource:r,content:n,finish:r=>{!function(t,e,r){"string"==typeof t[e]?t[e]=r.url:t[e].url=r.url}(t,e,r)}})}function $(t,e,r){return"string"==typeof t?{url:e}:new Blob([JSON.stringify(t.toJSON(r))],{type:"application/json"})}export{R as g};
