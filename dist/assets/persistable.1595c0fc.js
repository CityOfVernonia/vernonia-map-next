var t=Object.defineProperty,e=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;import{eP as a,jN as p,ab as c,jO as u,jP as l,bh as f,jQ as g,jR as m,jS as y,jT as j,jU as h,jV as v,eN as b,eO as d,jW as w}from"./vendor.9770a310.js";import{i as O}from"./multiOriginJSONSupportUtils.8ffcafd7.js";function P(t){return I[function(t){return t instanceof Blob?t.type:function(t){const e=a(t);return S[e]||U}(t.url)}(t)]||x}const I={},U="text/plain",x=I[U],S={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const F in S)I[S[F]]=F;function R(t){const v=c(t)&&t.origins?t.origins:[void 0];return(b,d)=>{const I=function(t,p,v){if(c(t)&&"resource"===t.type)return function(t,p,v){const b=h(p,v);return{type:String,read:(t,e,r)=>{const n=u(t,e,r);return b.type===String?n:"function"==typeof b.type?new b.type({url:n}):void 0},write:{writer(p,u,h,d){if(!d||!d.resources)return"string"==typeof p?void(u[h]=l(p,d)):void(u[h]=p.write({},d));const w=function(t){return f(t)?null:"string"==typeof t?t:t.url}(p),I=w?l(w,((t,n)=>e(t,r(n)))(((t,e)=>{for(var r in e||(e={}))o.call(e,r)&&s(t,r,e[r]);if(n)for(var r of n(e))i.call(e,r)&&s(t,r,e[r]);return t})({},d),{verifyItemRelativeUrls:d&&d.verifyItemRelativeUrls?{writtenUrls:d.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null}),1):null,U=b.type!==String&&(!O(this)||d&&d.origin&&this.originIdOf(v)>g(d.origin));d&&d.portalItem&&c(I)&&!m(I)?U?function(t,e,r,n,o,i,s,p){const c=s.portalItem.resourceFromPath(n),u=$(r,n,s);P(u)===a(c.path)?(z(t,e,c,u,s.resources.toUpdate),o[i]=n):N(t,e,r,n,o,i,s,p)}(this,v,p,I,u,h,d,t):function(t,e,r,n){n.resources.toKeep.push({resource:n.portalItem.resourceFromPath(t)}),e[r]=t}(I,u,h,d):d&&d.portalItem&&(f(I)||c(y(I))||j(I)||U)?N(this,v,p,I,u,h,d,t):u[h]=I}}}}(t,p,v);switch(c(t)&&t.type?t.type:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:t,write:e}=w;return{read:t,write:e}}}}(t,b,d);for(const t of v){const e=p(b,t,d);for(const t in I)e[t]=I[t]}}}function N(t,e,r,n,o,i,s,a){const p=v(),c=$(r,n,s),u=b(d(a,"prefix"),p),l=`${u}.${P(c)}`,f=s.portalItem.resourceFromPath(l);j(n)&&s.resources.pendingOperations.push(async function(t){const e=(await import("./vendor.9770a310.js").then((function(t){return t.s4}))).default,{data:r}=await e(t,{responseType:"blob"});return r}(n).then((t=>{f.path=`${u}.${P(t)}`,o[i]=f.itemRelativeUrl})).catch((()=>{}))),z(t,e,f,c,s.resources.toAdd),o[i]=f.itemRelativeUrl}function z(t,e,r,n,o){o.push({resource:r,content:n,finish:r=>{!function(t,e,r){"string"==typeof t[e]?t[e]=r.url:t[e].url=r.url}(t,e,r)}})}function $(t,e,r){return"string"==typeof t?{url:e}:new Blob([JSON.stringify(t.toJSON(r))],{type:"application/json"})}export{R as g};
