import{ci as n,cK as t,cY as s,cL as i,cs as e,cI as m,cj as x,cn as a,cZ as r,c_ as o,c$ as c,d0 as f}from"./vendor.9770a310.js";function u(n){if(!n)return null;if("mesh"===n.type)return n.toJSON();let u=null;const p=n.spatialReference,g=t(p);if(!g)return n.toJSON();const v=p.isWebMercator?102100:4326,M=s[v].maxX,J=s[v].minX,N=s[v].plus180Line,O=s[v].minus180Line;let S;const b=n.toJSON();if(i(b))S=l(b,M,J);else if(e(b))b.points=b.points.map((n=>l(n,M,J))),S=b;else if(m(b))S=function(n,t){if(!t)return n;const s=function(n,t){const s=[],{ymin:i,ymax:e}=n,m=n.xmax-n.xmin,x=n.xmin,a=n.xmax;let r;const[o,c]=t.valid;r=y(n.xmin,t);const f=r.x,u=r.frameId;r=y(n.xmax,t);const l=r.x,p=r.frameId,d=f===l&&m>0;if(m>2*c){const n={xmin:x<a?f:l,ymin:i,xmax:c,ymax:e},t={xmin:o,ymin:i,xmax:x<a?l:f,ymax:e},m={xmin:0,ymin:i,xmax:c,ymax:e},r={xmin:o,ymin:i,xmax:0,ymax:e},y=[],d=[];h(n,m)&&y.push(u),h(n,r)&&d.push(u),h(t,m)&&y.push(p),h(t,r)&&d.push(p);for(let s=u+1;s<p;s++)y.push(s),d.push(s);s.push({extent:n,frameIds:[u]},{extent:t,frameIds:[p]},{extent:m,frameIds:y},{extent:r,frameIds:d})}else f>l||d?s.push({extent:{xmin:f,ymin:i,xmax:c,ymax:e},frameIds:[u]},{extent:{xmin:o,ymin:i,xmax:l,ymax:e},frameIds:[p]}):s.push({extent:{xmin:f,ymin:i,xmax:l,ymax:e},frameIds:[u]});return s}(n,t).map((n=>n.extent));return s.length<2?s[0]||n:s.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:s.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}(b,g);else if(x(b)||a(b)){const n=I;r(n,b);const t={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},s=f(t.xmin,J)*(2*M),i=0===s?b:function(n,t){const s=c(n);for(const i of s)for(const n of i)n[0]+=t;return n}(b,s);t.xmin+=s,t.xmax+=s,o(t,N)&&t.xmax!==M||o(t,O)&&t.xmin!==J?u=i:S=i}else S=n.toJSON();return null!==u?(new d).cut(u,M):S}function l(n,t,s){if(Array.isArray(n)){const i=n[0];if(i>t){const s=f(i,t);n[0]=i+s*(-2*t)}else if(i<s){const t=f(i,s);n[0]=i+t*(-2*s)}}else{const i=n.x;if(i>t){const s=f(i,t);n.x+=s*(-2*t)}else if(i<s){const t=f(i,s);n.x+=t*(-2*s)}}return n}function y(n,t){const[s,i]=t.valid,e=2*i;let m,x=0;return n>i?(m=Math.ceil(Math.abs(n-i)/e),n-=m*e,x=m):n<s&&(m=Math.ceil(Math.abs(n-s)/e),n+=m*e,x=-m),{x:n,frameId:x}}function h(n,t){const{xmin:s,ymin:i,xmax:e,ymax:m}=t;return p(n,s,i)&&p(n,s,m)&&p(n,e,m)&&p(n,e,i)}function p(n,t,s){return t>=n.xmin&&t<=n.xmax&&s>=n.ymin&&s<=n.ymax}class d{cut(n,t){let s;if(n.rings)this.closed=!0,s=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,s=n.paths,this.minPts=2}const i=s.length,e=-2*t;for(let m=0;m<i;m++){const n=s[m];if(n&&n.length>=this.minPts){const t=[];for(const s of n)t.push([s[0]+e,s[1]]);s.push(t)}}return this.closed?n.rings=s:n.paths=s,n}}const I=n();export{u as l};
