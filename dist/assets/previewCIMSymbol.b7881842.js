import{qa as e,qb as t,la as a}from"./vendor.9770a310.js";import{CIMSymbolRasterizer as l}from"./CIMSymbolRasterizer.31f52766.js";import"./cimAnalyzer.8999da49.js";import"./CIMSymbolHelper.b9e7d312.js";import"./callExpressionWithFeature.dc30a8fa.js";import"./Rasterizer.7daae759.js";const i=new l(null,!0);async function o(l,o={}){const{size:s,maxSize:n,node:r,opacity:m}=o,c=o.cimOptions||o,{feature:d,fieldMap:p,geometryType:y,style:h}=c,u=e(l),b=Math.min(null!=s?s:u,null!=n?n:a(120));b!==u&&(l=l.clone(),t(l,b,{preserveOutlineWidth:!0}));let g=3;l&&l.data&&l.data.symbol&&"CIMPointSymbol"!==l.data.symbol.type&&(g=1);const M=await i.rasterizeCIMSymbolAsync(l,d,p,y,{scaleFactor:g,style:h}),f=document.createElement("canvas");f.width=M.imageData.width,f.height=M.imageData.height,f.getContext("2d").putImageData(M.imageData,0,0);let C=f.width/g,I=f.height/g;if(null!=s&&(null==(null==o?void 0:o.scale)||(null==o?void 0:o.scale))){const e=C/I;C=e<=1?Math.ceil(b*e):b,I=e<=1?b:Math.ceil(b/e)}const w=new Image(C,I);return w.src=f.toDataURL(),null!=m&&(w.style.opacity=`${m}`),r&&r.appendChild(w),w}export{o as previewCIMSymbol};
